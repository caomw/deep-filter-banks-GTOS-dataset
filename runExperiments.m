function runExperiments()
% Run Hashing for Material Recognition Experiments
% Copyright (C) 2016 Hang Zhang, Rutgers University

setup;
global index;
index = 1;

path_model_vgg_m = 'data/models/imagenet-vgg-m.mat';

%% encodings

% RCNN (FC-CNN) flavors
rcnn.name = 'rcnn' ;
rcnn.opts = {...
    'type', 'rcnn', ...
    'model', path_model_vgg_m, ...
    'layer', 19} ;


dcnn.name = 'dcnnfv' ;
dcnn.opts = {...
    'type', 'dcnn', ...
    'model', path_model_vgg_m, ...
    'layer', 13, ...
    'numWords', 64, ...
    'encoderType', 'fv'};


dcnnvlad.name = 'dcnnvlad' ;
dcnnvlad.opts = {...
    'type', 'dcnn', ...
    'model', path_model_vgg_m, ...
    'layer', 13, ...
    'numWords', 64, ...
    'encoderType', 'vlad'} ;

dsift.name = 'dsift' ;
dsift.opts = {...
    'type', 'dsift', ...
    'numWords', 256, ...
    'numPcaDimensions', 80} ;

% Set of experiments to run
setupNameList = { 'dcnnvlad' }; %'rcnn', 'dcnn', 'dsift',
encoderList = {{dcnnvlad} }; % {rcnn}, {dcnn}, {dsift}, 
datasetList = {{'wild',1}} ;%{'fmd',1},,{'kth', 1}{'dtd',1}{'reflectance',1}
%, ,, {'voc07',1}, {'os',1}


for ii = 1 : numel(datasetList)
    dataset = datasetList{ii} ;
    
    if iscell(dataset)
        numSplits = dataset{2} ;
        dataset = dataset{1} ;
    else
        numSplits = 1 ;
    end
    
    for jj = 1 : numSplits
        for ee = 1: numel(encoderList)
            os_train(...
                'dataset', dataset, ...
                'seed', jj, ...
                'encoders', encoderList{ee}, ...
                'prefix', 'exp01', ...
                'suffix', setupNameList{ee}, ...
                'printDatasetInfo', ee == 1, ...
                'writeResults', true, ...
                'useGpu', false, ...
                'gpuId', 1);
        end
    end
end

clear;
